<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.85.0" /><link rel="canonical" type="text/html" href="https://github.com/rancher-sandbox/cOS-toolkit/docs/development/">
<META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">


<link rel="shortcut icon" href="https://github.com/rancher-sandbox/cOS-toolkit/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="https://github.com/rancher-sandbox/cOS-toolkit/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="https://github.com/rancher-sandbox/cOS-toolkit/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="https://github.com/rancher-sandbox/cOS-toolkit/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="https://github.com/rancher-sandbox/cOS-toolkit/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="https://github.com/rancher-sandbox/cOS-toolkit/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="https://github.com/rancher-sandbox/cOS-toolkit/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="https://github.com/rancher-sandbox/cOS-toolkit/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="https://github.com/rancher-sandbox/cOS-toolkit/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="https://github.com/rancher-sandbox/cOS-toolkit/favicons/android-192x192.png" sizes="192x192">

<title>Development | cOS toolkit</title>
<meta name="description" content="cOS toolkit documentation website"><meta property="og:title" content="Development" />
<meta property="og:description" content="How to build cOS?
" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://github.com/rancher-sandbox/cOS-toolkit/docs/development/" /><meta property="og:site_name" content="cOS toolkit" />

<meta itemprop="name" content="Development">
<meta itemprop="description" content="How to build cOS?
"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Development"/>
<meta name="twitter:description" content="How to build cOS?
"/>




<link rel="preload" href="https://github.com/rancher-sandbox/cOS-toolkit/scss/main.min.ce822e1833a5405e77f69584ab31fd4bd422643124926787ea63be001e51b0b2.css" as="style">
<link href="https://github.com/rancher-sandbox/cOS-toolkit/scss/main.min.ce822e1833a5405e77f69584ab31fd4bd422643124926787ea63be001e51b0b2.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>



<link rel="stylesheet" href="https://github.com/rancher-sandbox/cOS-toolkit/css/prism.css"/>





<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-00000000-0', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>


  </head>
  <body class="td-section">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="https://github.com/rancher-sandbox/cOS-toolkit/">
		<span class="navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="text-uppercase font-weight-bold">cOS toolkit</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				
				
				<a class="nav-link active" href="https://github.com/rancher-sandbox/cOS-toolkit/docs/" ><span class="active">Documentation</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://github.com/rancher-sandbox/cOS-toolkit/releases" target="_blank" ><i class='fab fa-github'></i><span>Github releases</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a class="nav-link" href="https://rancher-sandbox.github.io/cos-toolkit-package-browser/" target="_blank" ><i class='fa fa-toolbox'></i><span>Browse packages</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this site…"
  aria-label="Search this site…"
  autocomplete="off"
  
  data-offline-search-index-json-src="https://github.com/rancher-sandbox/cOS-toolkit/offline-search-index.16218b789da3ed98fdbaeb49bd2ae2d0.json"
  data-offline-search-base-href="https://github.com/rancher-sandbox/cOS-toolkit/"
  data-offline-search-max-results="10"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>
This the multi-page printable view of this section.
<a href="#" onclick="print();return false;">Click here to print</a>.
</p><p>
<a href="https://github.com/rancher-sandbox/cOS-toolkit/docs/development/">Return to the regular view of this page</a>.
</p>
</div>



<h1 class="title">Development</h1>
<div class="lead">How to build cOS?</div>




    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-be969bc49196171414c640b6e5d07e36">Creating derivatives</a></li>


    
  
    
    
	
<li>2: <a href="#pg-8a9a15a61c107bad2b137d10597cb9e8">Build Raw images</a></li>


    
  
    
    
	
<li>3: <a href="#pg-b891fcefc8f5da3d313248bffe32998d">Build requirements</a></li>


    
  

    </ul>


<div class="content">
      <p>Welcome!</p>
<p>The cOS (containerized OS) distribution is entirely built over GitHub. You can check the pipelines in the <code>.github</code> folder to see how the process looks like.</p>
<h2 id="repository-layout">Repository layout</h2>
<ul>
<li><code>packages</code>: contain packages definition for luet</li>
<li><code>values</code>: interpolation files, needed only for multi-arch and flavor-specific build</li>
<li><code>assets</code>: static files needed by the iso generation process</li>
<li><code>packer</code>: Packer templates</li>
<li><code>tests</code>: cOS test suites</li>
<li><code>manifest.yaml</code>: Is the manifest needed used to generate the ISO and additional packages to build</li>
</ul>
<h2 id="forking-and-test-on-your-own">Forking and test on your own</h2>
<p>By forking the <code>cOS-toolkit</code> repository, you already have the Github Action workflow configured to start building and pushing your own <code>cOS</code> fork.</p>
<p>The only changes required to keep in mind for pushing images:</p>
<ul>
<li>set <code>DOCKER_PASSWORD</code> and <code>DOCKER_USERNAME</code> as Github secrets, which are needed to push the resulting container images from the pipeline.</li>
<li>Tweak or set the <code>Makefile</code>&rsquo;s <code>REPO_CACHE</code> and <code>FINAL_REPO</code> accordingly. Those are used respectively for an image used for cache, and for the final image reference.</li>
</ul>
<p>Those are not required for building - you can disable image push (<code>--push</code>) from the <code>Makefile</code> or just by specifying e.g. <code>BUILD_ARGS=--pull</code> when calling the <code>make</code> targets.</p>
<h2 id="building-locally">Building locally</h2>
<p>cOS has a container image which can be used to build cOS locally in order to generate the cOS packages and the cOS iso from your checkout.</p>
<p>From your git folder:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$&gt; docker build -t cos-builder .
$&gt; docker run --privileged<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87">true</span> --rm -v /var/run/docker.sock:/var/run/docker.sock -v <span style="color:#000">$PWD</span>:/cOS cos-builder
</code></pre></div><p>or use the <code>.envrc</code> file:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$&gt; <span style="color:#204a87">source</span> .envrc
$&gt; cos-build
</code></pre></div><h3 id="build-all-packages-locally">Build all packages locally</h3>
<p>Building locally has a <a href="dependencies.md">set of dependencies</a> that
should be satisfied.</p>
<p>Then you can run</p>
<pre><code># make build
</code></pre><p>as root</p>
<p>To clean from previous runs, run <code>make clean</code>.</p>
<p><em>Note</em>: The makefile uses <a href="dev.md#yq-and-jq"><code>yq</code> and <code>jq</code></a> to
retrieve the packages to build from the iso specfile.</p>
<p>If you don&rsquo;t have <code>jq</code> and <code>yq</code> installed, you must pass by the packages manually with <code>PACKAGES</code> (e.g. <code>PACKAGES=&quot;system/cos live/systemd-boot live/boot live/syslinux&quot;</code>).</p>
<p>You might want to build packages running as <code>root</code> or <code>sudo -E</code> if you intend to preserve file permissions in the resulting packages (mainly for <code>xattrs</code>, and so on).</p>
<h3 id="build-iso">Build ISO</h3>
<p>If using SLES or openSUSE, first install the required deps:</p>
<pre><code># zypper in -y squashfs xorriso dosfstools
</code></pre><p>and then, simply run</p>
<pre><code># make local-iso
</code></pre><h3 id="testing-iso-changes">Testing ISO changes</h3>
<p>To test changes against a specific set of packages, you can for example:</p>
<pre><code># make PACKAGES=&quot;toolchain/yq&quot;  build local-iso
</code></pre><p>root is required because we want to keep permissions on the output packages (not really required for experimenting).</p>
<h3 id="run-with-qemu">Run with qemu</h3>
<p>After you have the iso locally, run</p>
<pre><code>
$&gt; QEMU=qemu-system-x86_64 make run-qemu

</code></pre><p>This will create a disk image at <code>.qemu/drive.img</code> and boot from the ISO.</p>
<blockquote>
<p>If the image already exists, it will NOT be overwritten.</p>
<p>You need to run an explicit <code>make clean_run</code> to wipe the image and
start over.</p>
</blockquote>
<h4 id="installing">Installing</h4>
<p>With a fresh <code>drive.img</code>, <code>make run-qemu</code> will boot from ISO. You can then log in as <code>root</code> with password <code>cos</code> and install cOS on
the disk image with:</p>
<pre><code># elemental install /dev/sda
</code></pre><h4 id="running">Running</h4>
<p>After a successful installation of cOS on <code>drive.img</code>, you can boot
the resulting sytem with</p>
<pre><code>
$&gt; QEMU_ARGS=&quot;-boot c&quot; make run-qemu

</code></pre><h3 id="run-tests">Run tests</h3>
<p>Requires: Virtualbox or libvirt, vagrant, packer</p>
<p>We have a test suite which runs over SSH.</p>
<p>To create the vagrant image:</p>
<pre><code>
$&gt; PACKER_ARGS=&quot;-var='feature=vagrant' -only virtualbox-iso.cos&quot; make packer

</code></pre><p>To run the tests:</p>
<pre><code>
$&gt; make test

</code></pre>
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-be969bc49196171414c640b6e5d07e36">1 - Creating derivatives</h1>
    <div class="lead">This document summarize references to create derivatives with <code>cos-toolkit</code> by using the <code>luet</code> toolchain.</div>
	<p><code>cos-toolkit</code> is a manifest to share a common abstract layer between derivatives inheriting the same featureset.</p>
<p><code>cos</code> is a <a href="https://luet-lab.github.io/docs/docs/concepts/packages/specfile/#specfiles">Luet tree</a> and derivatives can be expressed as Luet trees as well that inherit part of the compilation specs from <code>cos</code>.</p>
<p>Those trees are then post-processed and converted to Dockerfiles when building packages, that in turn are used to build docker images and final artefacts.</p>
<h2 id="high-level-workflow">High level workflow</h2>
<p>The building workflow can be resumed in the following steps:</p>
<ul>
<li>Build packages from container images. This step generates build metadata (<code>luet build</code> / <code>docker build</code> / <code>buildah</code> ..)</li>
<li>Add repository metadata and create a repository from the build phase (<code>luet create-repo</code>)</li>
<li>(otherwise, optionally) publish the repository and the artefacts along (<code>luet create-repo --push-images</code>)</li>
</ul>
<p>While on the client side, the upgrade workflow is:</p>
<ul>
<li><code>luet install</code> (when upgrading from release channels) latest cos on a pristine image file</li>
<li>or <code>luet util unpack</code> (when upgrading from specific docker images)</li>
</ul>
<p><em>Note</em>: The manual build steps are not stable and will likely change until <a href="https://github.com/rancher-sandbox/cOS-toolkit/issues/108">we build a single CLI</a> to encompass the <code>cos-toolkit</code> components, rather use <code>source .envrc &amp;&amp; cos-build</code> for the moment being while iterating locally.</p>
<h2 id="single-image-os">Single image OS</h2>
<p>Derivatives are composed by a combination of specs to form a final package that is consumed as a single image OS.</p>
<p>The container image during installation and upgrade, is converted to an image file with a backing ext2 fs.</p>
<p>Packages in luet have <code>runtime</code> and <code>buildtime</code> specifications into <code>definition.yaml</code> and <code>build.yaml</code> respectively, and in the buildtime we set:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">requires</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:bold">category</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;system&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;cos&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">version</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&gt;=0&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#204a87;font-weight:bold">category</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;app&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">name</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;sampleOSService&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">version</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#4e9a06">&#34;&gt;=0&#34;</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><p>This instruct <code>luet</code> to compose a new image from the results of the compilation of the specified packages, without any version constraints, and use it to run any <code>steps</code> and <code>prelude</code> on top of it.</p>
<p>We are interested in the dependencies final images, and not the containers used to build them, so we enable <code>requires_final_images</code>:</p>
<pre><code>requires_final_images: true
</code></pre><p>We later run arbitrary steps to tweak the image:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">steps</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">...</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><p>And we instruct luet to compose the final artifact as a <code>squash</code> of the resulting container image, composed of all the files:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">unpack</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#204a87;font-weight:bold">true</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><p>A detailed explaination of all the keywords available <a href="https://luet-lab.github.io/docs/docs/concepts/packages/specfile/#keywords">is in the luet docs</a> along with the <a href="https://luet-lab.github.io/docs/docs/concepts/packages/specfile/#building-strategies">supported build strategies</a>.</p>
<p>We exclude then a bunch of file that we don&rsquo;t want to be in the final package (regexp supported):</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">excludes</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline"></span>- <span style="color:#000">..</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><h2 id="templating">Templating</h2>
<p>The package <code>build</code> definition supports <a href="https://luet-lab.github.io/docs/docs/concepts/packages/templates/">templating</a>, and global interpolation of build files with multiple values files.</p>
<p>Values file can be specified during build time in luet with the <code>--values</code> flag (also multiple files are allowed) and, if you are familiar with <code>helm</code> it using the same engine under the hood, so all the functions are available as well.</p>
<p><code>cos-toolkit</code> itself uses <a href="https://github.com/rancher-sandbox/cOS-toolkit/tree/master/values">default values files</a> for every supported distributions.</p>
<p>Templates uses cases are for: resharing common pieces between flavors, building for different platforms and architectures, &hellip;</p>
<h2 id="build-iso">Build ISO</h2>
<p>To build an iso for a derivative image <code>elemental build-iso</code> command can be used:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">elemental build-iso -n <span style="color:#000">$NAME</span> <span style="color:#000">$IMAGE</span>
</code></pre></div><p>Where <code>$NAME</code> is the name of the ISO and <code>$IMAGE</code> is the reference to the container image we are building the ISO for. See also <a href="../../creating-derivatives/build_iso">building ISOs</a></p>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-8a9a15a61c107bad2b137d10597cb9e8">2 - Build Raw images</h1>
    <div class="lead">This section documents the procedure to build cOS raw images which are used to boot into Cloud providers.</div>
	<p>Requirements:</p>
<ul>
<li><code>elemental</code> binary</li>
<li>elemental runtime dependencies</li>
</ul>
<p>The suggested approach high level view is building cOS packages and generating a RAW image from
them. That would allow us to transform that RAW image in a valid Azure/Google/Amazon Cloud blob that can be transformed into a VM image ready
to be launched.</p>
<p>This generates a <code>vanilla</code> image that boots into <a href="../../getting-started/recovery">recovery mode</a> and can be used to deploy
whatever image you want to the VM. Then you can snapshot that VM into a VM image ready to deploy with the default cOS
system or your derivative.</p>
<p>The RAW image can then be used into packer templates to generate custom Images, or used as-is with a userdata to deploy a container image of choice with an input user-data.</p>
<h2 id="getting-the-packages">Getting the packages</h2>
<p>By default, elemental will use the cos-toolkit repo to obtain the required packages to build the raw image.</p>
<p>We can also use locally built packages instead. Just run:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo make build
sudo make create-repo
</code></pre></div><p>All the artifacts will be generated under the <code>build</code> directory and a local repo will be created.</p>
<p>Then prepare a <code>manifest.yaml</code> file with the local repo, so build-disk can read from it:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">raw_image</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">x86_64</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># arch we are building for</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">repositories</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># list of repositories to use for getting the needed packages</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:bold">uri</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">/home/user/cos-toolkit/packages/</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">        </span><span style="color:#204a87;font-weight:bold">type</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">local</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><p>As long as elemental is launched from the directory where the <code>manifest.yaml</code> file is, it will pick up that local repo and use the local packages to build the raw image.</p>
<p>Note that you can do the same to override the default remote repository, in order to use your own remote repository:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#204a87;font-weight:bold">raw_image</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">  </span><span style="color:#204a87;font-weight:bold">x86_64</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># arch we are building for</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">    </span><span style="color:#204a87;font-weight:bold">repositories</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#8f5902;font-style:italic"># list of repositories to use for getting the needed packages</span><span style="color:#f8f8f8;text-decoration:underline">
</span><span style="color:#f8f8f8;text-decoration:underline">      </span>- <span style="color:#204a87;font-weight:bold">uri</span><span style="color:#000;font-weight:bold">:</span><span style="color:#f8f8f8;text-decoration:underline"> </span><span style="color:#000">https://my.custom.repo</span><span style="color:#f8f8f8;text-decoration:underline">
</span></code></pre></div><h2 id="building-the-raw-image">Building the RAW image</h2>
<p>The RAW image is just a RAW disk image that contains the recovery, so once launched is ready to be used for installing
whatever cOS or derivative that you want into the VM disks. This allows us to have a barebones base image that can be
used for provisioning whatever cOS you want.</p>
<p>Building the RAW image is as simple as running:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo elemental build-disk
</code></pre></div><p>This will output a <code>disk.raw</code> file in the current directory which can be run with qemu, see <a href="../../getting-started/booting">booting</a>.</p>
<h3 id="aws">AWS</h3>
<p>No other steps are required, the raw disk can be already booted as an AMI image, see <a href="../../getting-started/booting">booting</a>.</p>
<h3 id="azure">Azure</h3>
<p>Requirements:</p>
<ul>
<li>Azure Cloud access keys with the appropriate roles and permissions</li>
<li><a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli">azure-cli</a></li>
</ul>
<h4 id="transform-the-raw-image-into-a-compatible-azure-cloud-blob">Transform the RAW image into a compatible Azure Cloud blob</h4>
<p>Currently importing images from storage blobs on Azure Cloud have a <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/linux/create-upload-generic">few requirements</a>:</p>
<ul>
<li>only fixed VHD format is supported</li>
<li>VHD disk must have a virtual size aligned to 1 MB</li>
<li>LVM is not supported</li>
<li>no swap partition</li>
</ul>
<p>Elemental provides a <code>--type</code> flag that can be used to output an azure image directly:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo elemental build-disk -t azure
</code></pre></div><p>This will create a <code>disk.raw.vhd</code> which is our final artifact</p>
<p>Elemental also provides a convert command that can turn a previously created RAW image into an azure image:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">elemental convert-disk -t azure --keep-source disk.raw
</code></pre></div><h4 id="uploading-to-azure-cloud-storage-and-importing-it-as-an-image">Uploading to Azure Cloud storage and importing it as an image</h4>
<p>The last step is to upload the blob to Azure Cloud storage and import that blob as a valid image.</p>
<p>With <a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli">azure-cli</a> installed
and its credentials configured, you upload the blob with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">az storage copy --source &lt;cos-azure-image&gt; --destination https://&lt;account&gt;.blob.core.windows.net/&lt;container&gt;/&lt;destination-cos-azure-image&gt;
</code></pre></div><p>And import it as an image with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">az image create --resource-group &lt;resource-group&gt; --source https://&lt;account&gt;.blob.core.windows.net/&lt;container&gt;/&lt;cos-azure-image&gt; --os-type linux --hyper-v-generation v2 --name &lt;image-name&gt;
</code></pre></div><p>Where cos-azure-image is the blob we just uploaded, basically you can use the same value as you set in <code>--destionation</code> for the upload</p>
<p>Note that we used <code>--os-type linux --hyper-v-generation v2</code> as flags. This indicates that the image will be booted with UEFI
and its required. Otherwise, launching the image will try to boot it in legacy mode, and it will fail.</p>
<p>Once this is over you will have you cOS (or derivative) vanilla image ready for consumption.
You can see your new image by running:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">az image show --resource-group &lt;resource-group&gt; --name &lt;image-name&gt;
</code></pre></div><h3 id="google-cloud">Google cloud</h3>
<p>Requirements:</p>
<ul>
<li>Google Cloud access keys with the appropriate roles and permissions</li>
<li><a href="https://cloud.google.com/storage/docs/gsutil">gsutil</a> and <a href="https://cloud.google.com/sdk">gcloud</a> tools</li>
</ul>
<h4 id="transform-the-raw-image-into-a-compatible-google-cloud-blob">Transform the RAW image into a compatible Google Cloud blob</h4>
<p>Currently importing images from storage blobs on Google Cloud have a <a href="https://cloud.google.com/compute/docs/import/import-existing-image#requirements_for_the_image_file">few requirements</a>:</p>
<ul>
<li>blobs have to be tar.gzipped with the flag <code>--format=oldgnu</code></li>
<li>the disk.raw has to be rounded up to the next Gb ( so no 2.1gb images or 2.4, they need to be an exact 3Gb or 2Gb)</li>
<li>image inside the tar.gzip blob needs to be called disk.raw</li>
</ul>
<p>Elemental provides a <code>--type</code> flag that can be used to output a GCE image directly:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo elemental build-disk -t gce
</code></pre></div><p>This will create a <code>disk.raw.tar.gz</code> which is our final artifact</p>
<p>Elemental also provides a convert command that can turn a previously created RAW image into an azure image:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">elemental convert-disk -t gce --keep-source disk.raw
</code></pre></div><h4 id="uploading-to-google-cloud-storage-and-importing-it-as-an-image">Uploading to Google Cloud storage and importing it as an image</h4>
<p>The last step is to upload the blob to Google Cloud storage and import that blob as a valid image.</p>
<p>With <a href="https://cloud.google.com/storage/docs/gsutil">gsutil</a> and <a href="https://cloud.google.com/sdk">gcloud</a> tools installed
and their credentials configured, you upload the blob with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gsutil cp disk.raw.tar.gz gs://YOURBUCKET/
</code></pre></div><p>Where YOURBUCKET is the destination bucket you want your file to end up in.</p>
<p>And import it as an image with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gcloud compute images create IMAGENAME --source-uri<span style="color:#ce5c00;font-weight:bold">=</span>SOURCEURI --guest-os-features<span style="color:#ce5c00;font-weight:bold">=</span>UEFI_COMPATIBLE
</code></pre></div><p>Where:</p>
<ul>
<li>IMAGENAME: The name for the final image</li>
<li>SOURCEURI: The full Google Cloud Storage URI where the disk image is stored.
This file must be a gzip-compressed tarball whose name ends in
.tar.gz.
This is the full path to the blob we just uploaded.</li>
</ul>
<p>Note that we used <code>--guest-os-features=UEFI_COMPATIBLE</code> as a flag. This indicates that the image will be booted with UEFI
and its required. Otherwise, launching the image will try to boot it in legacy mode and it will fail.</p>
<p>Once this is over you will have you cOS (or derivative) vanilla image ready for consumption.
You can see your new image by running:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gcloud compute images describe IMAGENAME
</code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-b891fcefc8f5da3d313248bffe32998d">3 - Build requirements</h1>
    <div class="lead">Building prerequisites</div>
	<h3 id="installing-required-dependencies-for-local-build">Installing required dependencies for local build</h3>
<p>To get requirements installed locally, run:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$&gt; make deps
</code></pre></div><p>or you need:</p>
<ul>
<li><a href="https://github.com/mudler/luet"><code>luet</code></a></li>
<li><a href="https://github.com/rancher-sandbox/elemental"><code>elemental</code></a></li>
<li><a href="https://github.com/plougher/squashfs-tools"><code>squashfs-tools</code></a>
<ul>
<li><code>zypper in squashfs</code> on SLES or openSUSE</li>
</ul>
</li>
<li><a href="https://dev.lovelyhq.com/libburnia/web/wiki/Xorriso"><code>xorriso</code></a>
<ul>
<li><code>zypper in xorriso</code> on SLES or openSUSE</li>
</ul>
</li>
<li><a href="https://www.gnu.org/software/mtools/"><code>mtools</code></a>
<ul>
<li><code>zypper in mtools</code> on SLES or openSUSE</li>
</ul>
</li>
<li><code>yq</code> (<a href="https://github.com/mikefarah/yq/releases">version <code>4.x</code></a>), installed via <a href="https://github.com/rancher-sandbox/cOS-toolkit/tree/master/packages/toolchain/yq">packages/toolchain/yq</a> (optional)</li>
<li><a href="https://stedolan.github.io/jq"><code>jq</code></a>, installed via <a href="https://github.com/rancher-sandbox/cOS-toolkit/tree/master/packages/utils/jq">packages/utils/jq</a> (optional)</li>
</ul>
<p><em>Note</em>: Running <code>make</code> deps will install only <code>luet</code>, <code>luet-makeiso</code>, <code>yq</code> and <code>jq</code>. <code>squashfs-tools</code> and <code>xorriso</code> needs to be provided by the OS.</p>
<h3 id="manually-install-dependencies">Manually install dependencies</h3>
<p>To install luet locally, you can also run as root:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># curl https://raw.githubusercontent.com/rancher-sandbox/cOS-toolkit/master/scripts/get_luet.sh | sh</span>
</code></pre></div><p>or build <a href="https://github.com/mudler/luet">luet from source</a>).</p>
<p>You can find more luet components in the official <a href="https://github.com/Luet-lab/luet-repo">Luet repository</a>.</p>
<h4 id="elemental">elemental</h4>
<p><code>elemental</code> comes <a href="https://github.com/rancher-sandbox/cOS-toolkit/tree/master/packages/toolchain/elemental-cli">with cOS-toolkit</a>
and can be installed with <code>luet</code> locally:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$&gt; luet install -y toolchain/elemental-cli
</code></pre></div><p>You can also grab the binary from <a href="https://github.com/rancher-sandbox/elemental">elemental</a> releases.</p>
<h4 id="yq-and-jq">yq and jq</h4>
<p><code>yq</code> (version <code>4.x</code>) and <code>jq</code> are used to retrieve the list of
packages to build in order to produce the final ISOs. Those are not
strictly required, see the Note below.</p>
<p>They are installable with:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$&gt; luet install -y utils/jq toolchain/yq
</code></pre></div><p><em>Note</em>: <code>yq</code> and <code>jq</code> are just used to generate the list of packages to build, and you don&rsquo;t need to have them installed if you manually specify the packages to be compiled.</p>

</div>



    
	
  



          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="Slack" aria-label="Slack">
    <a class="text-white" target="_blank" rel="noopener" href="https://rancher-users.slack.com/messages/cos-toolkit" aria-label="Slack">
      <i class="fab fa-slack"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2022 SUSE LLC All Rights Reserved</small>
        <small class="ml-1"><a href="https://www.suse.com/company/legal/" target="_blank" rel="noopener">Privacy Policy</a></small>
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF" crossorigin="anonymous"></script>






 













<script src="https://github.com/rancher-sandbox/cOS-toolkit/js/main.min.3b172c13b62c2bea8b1c9d2599cddc8cf89718a92d792c680871c81ba43d8c85.js" integrity="sha256-OxcsE7YsK&#43;qLHJ0lmc3cjPiXGKkteSxoCHHIG6Q9jIU=" crossorigin="anonymous"></script>



<script src='https://github.com/rancher-sandbox/cOS-toolkit/js/prism.js'></script>



  </body>
</html>
